"use strict";

var _logic = require("./logic.js");

var _data = require("../data.js");

var data = _interopRequireWildcard(_data);

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }

function calcTime(e) {
  var t = document.querySelector(".am-pm");var n = void 0;n = e.includes(":30") ? e.replace(":30", ".5") : e.includes(":45") ? e.replace(":45", ".75") : e.replace(":", "."), (0, _logic.buildWatch)(!0, n).then(function (e) {
    t.textContent = e.split(":")[0] > 12 ? "PM" : "AM";
  });
}function afterTimeZoneSelection(e) {
  var t = document.querySelector(".filter-div"),
      n = document.querySelector(".current-zone"),
      r = document.querySelector(".dst-info"),
      o = document.querySelector('input[name="country"]');emptyParent(t), o.value = "", n.textContent = "Current zone: " + e.country;var c = document.querySelector("#day-saving-checkbox");r.innerHTML = formatDSTinfo(e), c.checked = !1, c.disabled = "-" === e.DST;
}function formatDSTinfo(e) {
  if ("-" !== e.DST) {
    var t = void 0,
        n = void 0;return "Chatham Islands (New Zealand)" !== e.country && "Iran" !== e.country ? (t = e.DSTperiodStartEnd.split(":00 ")[0] + ":00", n = e.DSTperiodStartEnd.split(":00 ")[1]) : "Chatham Islands (New Zealand)" === e.country ? (t = e.DSTperiodStartEnd.split(":45 ")[0] + ":45", n = e.DSTperiodStartEnd.split(":45 ")[1]) : e.country, "<div class=\"start\"><span>Starts on:</span><span>" + t + "</span></div>\n          <div class=\"end\"><span>Ends on:</span><span>" + n + "</span></div>";
  }return "";
}function emptyParent(e) {
  for (; 0 !== e.children.length;) {
    e.childNodes[0].remove();
  }
}(0, _logic.buildWatch)().then(function (e) {
  var t = document.querySelector(".am-pm");document.querySelector(".watch").classList.remove("d-none"), t.classList.remove("d-none"), t.textContent = e.split(":")[0] > 12 ? "PM" : "AM";
}), "serviceWorker" in navigator && window.addEventListener("load", function () {
  navigator.serviceWorker.register("../sw_cached_site.js").catch(function (e) {
    return console.log("Service Worker: Error: " + e);
  });
});var input = document.querySelector('input[name="country"]');input.addEventListener("change", function (e) {
  var t = document.querySelector("#day-saving-checkbox");t.addEventListener("change", function (e) {
    var t = document.querySelector(".current-zone").textContent.split("zone: ")[1],
        n = data.data.filter(function (e) {
      return e.country === t;
    })[0];e.target.checked ? calcTime(n.DST) : calcTime(n.UTCoffset);
  });var n = [];data.data.forEach(function (t) {
    t.country.toLowerCase().includes(e.target.value.toLowerCase()) && n.push(t);
  });var r = document.querySelector(".filter-div");n.length > 1 ? (r.innerHTML = "", n.forEach(function (e) {
    r.innerHTML += "<span class=\"filtered\"><a>" + e.country + "</a></span>";
  }), r.querySelectorAll("a").forEach(function (e, t) {
    e.addEventListener("click", function () {
      calcTime(n[t].UTCoffset), afterTimeZoneSelection(n[t]);
    });
  })) : 1 === n.length ? (calcTime(n[0].UTCoffset), afterTimeZoneSelection(n[0])) : r.textContent = "Sorry, No match found.";
});